language: go
go:
- 1.5
sudo: false
env:
  global:
    secure: msIooVyMAnZDwJh7izLylmdClEY8oKBMry5bqCuEG9Z+srYibmx5DNdjNhx4YRBlIeRyYwBxWirVwVZDXsRbUIeXslM1ZCnuWirfYDlB7WpyfLI7DUsNdvFK155NAst/CG41hU7LdplW3YSzQcE6uFy8z7qLd8UEIPlCWPn4rBnix0MjdptNtTq+Kfp/iUKdbMYYGrxrwABQJZzzuC/QTzayC2cG7CL6RwZpt8maA+zM7Q3I0cfRdPmTQxswAyquLWdV8X9ddi3Ad618WSCr/gHqY+sF7CptaLqzYx6gxSlcqxekVjVTO9WiQBp3CKi4BM9HMvL7dFgdcYfJOrhc7GaFDO+QxDS9fog5TcHzHf1n9VzIjIOHtPyARxFwOWdRD9mhpW6FErEoQqAleHm44OXKeJEfEpq4/vq9ygVpZQXXVf2dT6WpIJjP9hFLhG9cH1TN6r9+Ru3FI6DUGhRSvUDWOb6Jn29fZkSLFXToHAzz6HpX5SDtQMW2xv/D9mq0krY+ubU2rTv0cqp6fTv3b10oDAR4GMB+N4FcbqbVTveHoE9Do1EvkVf0GzSOyNqsLB4b2O/QrZovhpbP0ZlPeDyEW7xrcy846ohFQ0Ehs/f/H4gEjZYVVGOqYnRURDiCKxfb3svJXmx2fMnzsvpuK6/yzelunXVuuo7B7j3uesI=
before_install:
  - go get github.com/axw/gocov/gocov
  - go get github.com/mattn/goveralls
  - go get golang.org/x/tools/cmd/cover
  - go get github.com/modocache/gover
  - go get github.com/mitchellh/gox
  - go get -v ./...
script:
  - if [[ $TRAVIS_PULL_REQUEST == "true" ]]; then make distclean all goveralls; else make distclean all crossbuild goveralls; fi
after_success:
  - ./scripts/travis_github_releases.sh
deploy:
  provider: releases
  api_key:
    secure: msIooVyMAnZDwJh7izLylmdClEY8oKBMry5bqCuEG9Z+srYibmx5DNdjNhx4YRBlIeRyYwBxWirVwVZDXsRbUIeXslM1ZCnuWirfYDlB7WpyfLI7DUsNdvFK155NAst/CG41hU7LdplW3YSzQcE6uFy8z7qLd8UEIPlCWPn4rBnix0MjdptNtTq+Kfp/iUKdbMYYGrxrwABQJZzzuC/QTzayC2cG7CL6RwZpt8maA+zM7Q3I0cfRdPmTQxswAyquLWdV8X9ddi3Ad618WSCr/gHqY+sF7CptaLqzYx6gxSlcqxekVjVTO9WiQBp3CKi4BM9HMvL7dFgdcYfJOrhc7GaFDO+QxDS9fog5TcHzHf1n9VzIjIOHtPyARxFwOWdRD9mhpW6FErEoQqAleHm44OXKeJEfEpq4/vq9ygVpZQXXVf2dT6WpIJjP9hFLhG9cH1TN6r9+Ru3FI6DUGhRSvUDWOb6Jn29fZkSLFXToHAzz6HpX5SDtQMW2xv/D9mq0krY+ubU2rTv0cqp6fTv3b10oDAR4GMB+N4FcbqbVTveHoE9Do1EvkVf0GzSOyNqsLB4b2O/QrZovhpbP0ZlPeDyEW7xrcy846ohFQ0Ehs/f/H4gEjZYVVGOqYnRURDiCKxfb3svJXmx2fMnzsvpuK6/yzelunXVuuo7B7j3uesI=
  file:
    - builds/polochon_darwin_amd64
    - builds/polochon_linux_amd64
    - builds/polochon_linux_arm
  skip_cleanup: true
  on:
    repo: xunien/polochon
    tags: true
